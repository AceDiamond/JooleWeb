
@{
    ViewBag.Title = "Search";
}

    <div class="container" style="margin-top: 30%">
        <h1 style="text-align: center; margin-bottom: 25px">Building Product Selection Platform</h1>
        @using (@Html.BeginForm())
        {
            <div class="row">
                <div class="col-xs-8 col-xs-offset-2">
                    <div class="input-group">
                        @*<div class="input-group-btn search-panel">
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <span id="search_concept">Catagrey</span> <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#electrical">Electrical</a></li>
                                <li><a href="#furniture">Furniture</a></li>
                                <li class="divider"></li>
                                <li><a href="#all">Anything</a></li>
                            </ul>

                        </div>*@
                        @Html.DropDownList("Category", null, "", new { @class = "btn btn-secondary dropdown-toggle" })
                        @*<input type="hidden" name="search_param" value="all" id="search_param">*@
                        <input type="search" class="form-control" name="term" id="searchBox" placeholder="Search term...">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button"><span class="glyphicon glyphicon-search"></span></button>
                        </span>
                    </div>
                </div>
            </div>
        }

        @section scripts{
            <script>

                //console.log(idPAss);
                $("#searchBox").autocomplete({
                    source: function (request, response) {
                        var dat = JSON.stringify({
                            'term': $("#searchBox").val(),
                            'Category': $("#Category").val(),

                        });
                        $.ajax({
                            data: {
                                'term': $("#searchBox").val(),
                                'Category': $("#Category").val()
                            },
                            url: '@Url.Action("Autocomplete","Search")',
                            dataType: "json",
                            contentType: "application/json;charset=utf-8",
                            success: function (data) {
                                var parsed = JSON.parse(data);
                                var newArray = [];
                                var i = 0;
                                $.each(parsed, function (key, val) {
                                    newArray[i] = val;
                                    i++;
                                });
                                console.log(newArray);
                                response(newArray);
                            },
                            error: response
                        });
                        console.log(response);
                    },
                    minLength: 1
                });

            </script>
        </div>
